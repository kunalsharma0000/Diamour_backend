(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1136],{4919:function(e,t,r){"use strict";var o=r(7437),c=r(2265),n=r(5482),a=r.n(n),s=r(6463),i=r(1818),l=r(8341),u=r(2126);t.Z=()=>{(0,s.useRouter)();let{step:e,nextStep:t,checkoutData:r,submitForm:n}=(0,i.w)(),{calculateTotalCost:d,shippingCharge:m,cartItems:p,discount:w,couponCode:y,setCouponCode:h,applyCoupon:f}=(0,l.i)(),[x,_]=(0,c.useState)(0),[v,S]=(0,c.useState)(0);(0,c.useEffect)(()=>{let e=async()=>{_(await d())},t=async()=>{S(await f(y))};y?(e(),t()):_(p.reduce((e,t)=>e+t.product.price*t.quantity,0))},[y]);let g=()=>{for(let e in r)if("paymentMethod"!==e&&""===r[e].trim()){alert("Please fill all the fields!");return}t()},O=async()=>{let e=p.map(e=>e.product.id),t=p.map(e=>({product_id:e.product.id,quantity:e.quantity,selectedColor:e.selectedColor,selectedSize:e.selectedSize})),o={...r};delete o.paymentMethod,o.phone_number=o.phone,delete o.phone;let c={product_ids:e,items:t,customer:o};y&&(c.coupon_code=y);try{let e=await u.Z.post("https://diamour-backend-7mz7m.ondigitalocean.app/core/payment/phonepe",c,{headers:{"Content-Type":"application/json"}});e.data&&(console.log("PhonePe payment successful:",e.data),window.location.href=e.data.payment_url)}catch(e){console.error("PhonePe payment error:",e)}},j=()=>{for(let e in r)if("paymentMethod"===e&&""===r[e].trim()){alert("Please Select a payment method!");return}O()},[B,C]=(0,c.useState)(y);return(0,o.jsxs)("div",{className:a().orderSummaryBox,children:[(0,o.jsxs)("div",{className:a().cwrPrice,children:[(0,o.jsxs)("div",{className:a().cwrpWrap,children:[(0,o.jsx)("div",{className:a().cwrpwLeft,children:"Subtotal"}),(0,o.jsxs)("div",{className:a().cwrpwRight,children:["₹ ",x,".00"]})]}),(0,o.jsxs)("div",{className:a().cwrpWrap,children:[(0,o.jsx)("div",{className:a().cwrpwLeft,children:"Discount"}),(0,o.jsxs)("div",{className:a().cwrpwRight,children:["₹ ",v.discount,".00"]})]})]}),(0,o.jsxs)("div",{className:a().cwrCoupon,children:[(0,o.jsx)("input",{type:"text",placeholder:"Coupon Code",value:B,onChange:e=>C(e.target.value)}),(0,o.jsx)("div",{className:a().cwrcBtn,onClick:()=>{h(B)},children:"Apply Coupon"})]}),(0,o.jsx)("div",{className:a().cwrLine}),(0,o.jsxs)("div",{className:a().cwrOffer,children:[(0,o.jsx)("div",{className:a().cwroStatus,children:(0,o.jsx)("div",{className:a().cwroStatusWrap})}),(0,o.jsxs)("div",{className:a().cwroText,children:[(0,o.jsxs)("div",{className:a().cwrotTop,children:["Get Free"," ",(0,o.jsx)("span",{style:{color:"#1A1E26",fontWeight:"900"},children:"Shipping"})," ","for orders over"," ",(0,o.jsx)("span",{style:{color:"#EB2606",fontWeight:"900"},children:"₹1,00,000.00"})]}),(0,o.jsx)("div",{className:a().cwrotBottom,children:"Continue Shopping"})]})]}),1===e&&(0,o.jsx)("div",{className:a().cwrBtn,onClick:()=>g(),children:"Continue to Payment"}),2===e&&(0,o.jsx)("div",{className:a().cwrBtn,onClick:()=>j(),children:"Buy Now!"}),(0,o.jsx)("div",{className:a().cwrLine})]})}},8341:function(e,t,r){"use strict";r.d(t,{Z:function(){return s},i:function(){return i}});var o=r(7437),c=r(2265);let n="cartItems",a=(0,c.createContext)();function s(e){let{children:t}=e,[r,s]=(0,c.useState)([]),[i,l]=(0,c.useState)(""),[u,d]=(0,c.useState)(0),[m,p]=(0,c.useState)(50);(0,c.useEffect)(()=>{s(JSON.parse(localStorage.getItem(n))||[])},[]),(0,c.useEffect)(()=>{localStorage.setItem(n,JSON.stringify(r))},[r]);let w=async e=>{console.log(e);try{let t=await fetch("https://diamour-backend-7mz7m.ondigitalocean.app/core/coupon/".concat(e)),r=await t.json();if(t.ok)return r;return alert("Invalid coupon code!"),l(""),0}catch(e){return console.log("Error fetching coupon:",e),alert("An error occurred while applying the coupon."),0}},y=async()=>{let e=await w(i),t=r.reduce((e,t)=>e+t.product.price*t.quantity,0),o=0;d(o="amount"===e.discount_type?e.discount:t*e.discount/100);let c=t-o;return c>1e5?(p(0),c-50):c};return(0,o.jsx)(a.Provider,{value:{cartItems:r,addToCart:(e,t,o,c)=>{r.find(t=>t.product.id===e.id&&t.selectedColor===o&&t.selectedSize===c)?alert("Item already in cart!"):s([...r,{product:e,quantity:t,selectedColor:o,selectedSize:c}])},removeFromCart:(e,t,o)=>{s(r.filter(r=>!(r.product.id===e&&r.selectedColor===t&&r.selectedSize===o)))},increaseQuantity:(e,t,o)=>{s(r.map(r=>r.product.id===e&&r.selectedColor===t&&r.selectedSize==o?{...r,quantity:r.quantity+1}:r))},decreaseQuantity:(e,t,o)=>{s(r.map(r=>r.product.id===e&&r.selectedColor===t&&r.selectedSize===o?{...r,quantity:Math.max(1,r.quantity-1)}:r))},calculateTotalCost:y,shippingCharge:m,discount:u,couponCode:i,setCouponCode:l,applyCoupon:w},children:t})}function i(){return(0,c.useContext)(a)}},1818:function(e,t,r){"use strict";r.d(t,{o:function(){return s},w:function(){return a}});var o=r(7437),c=r(2265);let n=(0,c.createContext)(),a=()=>(0,c.useContext)(n),s=e=>{let{children:t}=e,[r,a]=(0,c.useState)({name:"",phone:"",email:"",address:"",pincode:"",city:"",state:"",country:"",paymentMethod:""}),[s,i]=(0,c.useState)(1);return(0,o.jsx)(n.Provider,{value:{checkoutData:r,setCheckoutData:a,step:s,nextStep:()=>{i(s+1)},prevStep:()=>{i(s-1)},submitForm:()=>{console.log("Form submitted:",r)}},children:t})}},6463:function(e,t,r){"use strict";var o=r(1169);r.o(o,"useParams")&&r.d(t,{useParams:function(){return o.useParams}}),r.o(o,"useRouter")&&r.d(t,{useRouter:function(){return o.useRouter}})},9350:function(e,t,r){"use strict";r.d(t,{w_:function(){return i}});var o=r(2265),c={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},n=o.createContext&&o.createContext(c),a=function(){return(a=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var c in t=arguments[r])Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c]);return e}).apply(this,arguments)},s=function(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&0>t.indexOf(o)&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var c=0,o=Object.getOwnPropertySymbols(e);c<o.length;c++)0>t.indexOf(o[c])&&Object.prototype.propertyIsEnumerable.call(e,o[c])&&(r[o[c]]=e[o[c]]);return r};function i(e){return function(t){return o.createElement(l,a({attr:a({},e.attr)},t),function e(t){return t&&t.map(function(t,r){return o.createElement(t.tag,a({key:r},t.attr),e(t.child))})}(e.child))}}function l(e){var t=function(t){var r,c=e.attr,n=e.size,i=e.title,l=s(e,["attr","size","title"]),u=n||t.size||"1em";return t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className),o.createElement("svg",a({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,c,l,{className:r,style:a(a({color:e.color||t.color},t.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),i&&o.createElement("title",null,i),e.children)};return void 0!==n?o.createElement(n.Consumer,null,function(e){return t(e)}):t(c)}},5482:function(e){e.exports={orderSummaryBox:"OrderSummaryBox_orderSummaryBox__91Z64",cwrPrice:"OrderSummaryBox_cwrPrice__Mov3u",cwrpWrap:"OrderSummaryBox_cwrpWrap__l83Dp",cwrpwLeft:"OrderSummaryBox_cwrpwLeft__eSgcW",cwrpwRight:"OrderSummaryBox_cwrpwRight__3BOeE",cwrCoupon:"OrderSummaryBox_cwrCoupon__A2PYD",cwrcBtn:"OrderSummaryBox_cwrcBtn__x72uG",cwrOffer:"OrderSummaryBox_cwrOffer__X0ni2",cwroStatus:"OrderSummaryBox_cwroStatus__oTs4m",cwroStatusWrap:"OrderSummaryBox_cwroStatusWrap__HzyBi",cwroText:"OrderSummaryBox_cwroText__hxOog",cwrotTop:"OrderSummaryBox_cwrotTop__4YTCU",cwrotBottom:"OrderSummaryBox_cwrotBottom__VBNnX",cwrBtn:"OrderSummaryBox_cwrBtn__mp8cv",cwrLine:"OrderSummaryBox_cwrLine__xNQHG"}}}]);